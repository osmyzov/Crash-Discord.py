# osmuzov
# Crash Gambling v. 2.072021

import math
import random

import discord
from discord.ext import commands


class Crash(commands.Cog):
    def __init__(self, bot):
        self.bot = bot

    @commands.command()
    async def crash(self, ctx, bet: int = None, coef: float = None):
        if bet is None:
            await ctx.send(f"{ctx.author.name}, –£–∫–∞–∂–∏ —Å—É–º–º—É!")

        elif coef is None:
            await ctx.send(f"{ctx.author.name}, –£–∫–∞–∂–∏ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç!")

        elif coef <= 1:
            await ctx.send(f"{ctx.author.name}, –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –≤—ã—à–µ 1x!")

        else:
            coef = round(coef, 2)
            cash = 0  # –±–∞–ª–∞–Ω—Å —É—á–∞—Å—Ç–Ω–∏–∫–∞ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
            if cash < bet:
                await ctx.send(f"{ctx.author.name}, –£ —Ç–µ–±—è –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–µ–Ω–µ–≥!")

            else:
                # –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ –±–µ—Ç—Ç–∏–Ω–≥—É (10/100000)
                if bet < 10:
                    await ctx.send("–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–∞–≤–∫–∞ 10 –º–æ–Ω–µ—Ç!")
                elif bet > 100000:
                    await ctx.send("–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å—Ç–∞–≤–∫–∞ 100000 –º–æ–Ω–µ—Ç!")

                else:
                    # –î–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –≤ —Ä–µ–∂–∏–º–µ Crash —Ç—Ä–µ–±—É–µ—Ç—Å—è 1 —Å–ª—É—á–∞–π–Ω–æ–µ —á–∏—Å–ª–æ –≤ –∏–Ω—Ç–µ—Ä–≤–∞–ª–µ (0..1),
                    # –∫–æ—Ç–æ—Ä–æ–µ –∑–∞—Ç–µ–º –ø–µ—Ä–µ–≤–æ–¥–∏—Ç—Å—è –≤ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç Crash, –∏–º–µ—é—â–∏–π —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ,
                    # –ø–æ —Å–ª–µ–¥—É—é—â–µ–º—É –∞–ª–≥–æ—Ä–∏—Ç–º—É.
                    number = random.uniform(0, 1)
                    crashOutcome = 1000000 / (math.floor(number * 1000000) + 1) * (1 - 0.05)

                    # –ò–Ω–æ–≥–¥–∞ –º–æ–∂–µ—Ç –≤—ã–ø–∞—Å—Ç—å —á–∏—Å–ª–æ –ø–æ —Ç–∏–ø—É 0.99 –∏–ª–∏ –º–µ–Ω—å—à–µ, –≤ —Å–∞–º–æ–π –∏–≥—Ä–µ —Ç–∞–∫–æ–≥–æ –Ω–µ—Ç,
                    # —ç—Ç–æ—Ç IF —Å–ø–∞—Å–∞–µ—Ç –æ—Ç —Ç–∞–∫–∏—Ö —Å–∏—Ç—É–∞—Ü–∏–∏.
                    if crashOutcome <= 1:
                        crashOutcome = 1.00

                    # –µ—Å–ª–∏ –∫–æ—ç—Ñ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤—ã—à–µ –∏–ª–∏ —Ä–∞–≤–µ–Ω –∫—Ä–∞—à—É, —Ç–æ –æ–Ω –≤—ã–∏–≥—Ä–∞–ª
                    if crashOutcome >= coef:
                        winCash = bet * coef - bet
                        roundWinCash = round(winCash)
                        await ctx.send(content=ctx.author.mention,
                                       embed=discord.Embed(
                                           title="üìà –°–ª–æ–º–∞–Ω–Ω—ã–π –ö—Ä–∞—à",
                                           description=f"{ctx.author.name}, "
                                                       f""f"—Ç—ã –≤—ã–∏–≥—Ä–∞–ª: **+{round(roundWinCash)} :dollar:**\n\n"
                                                       f"–ö–æ—ç—Ñ: **{round(crashOutcome, 2)}**\n"
                                                       f"–¢—ã –ø–æ—Å—Ç–∞–≤–∏–ª –Ω–∞ –∫–æ—ç—Ñ: **{round(coef, 2)}**\n"
                                                       f"–¢–≤–æ—è —Å—Ç–∞–≤–∫–∞: **{bet}**"))

                        # –¢—É—Ç —É–∂–µ –≤—Ö–æ–¥–∏—Ç –≤ —Å–∏–ª—É –≤–∞—à–∞ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö.
                        # –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è roundWinCash, —ç—Ç–æ –≤—ã–∏–≥—Ä—ã—à –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

                    # –∏–ª–∏ –ø—Ä–æ–∏–≥—Ä–∞–ª :(
                    else:
                        await ctx.send(content=ctx.author.mention,
                                       embed=discord.Embed(
                                           title="üìà –°–ª–æ–º–∞–Ω–Ω—ã–π –ö—Ä–∞—à",
                                           description=f"{ctx.author.name}, "
                                                       f"—Ç—ã –ø—Ä–æ–∏–≥—Ä–∞–ª: **{bet} :dollar:**\n\n"
                                                       f"–ö–æ—ç—Ñ: **{round(crashOutcome, 2)}**\n"
                                                       f"–¢—ã –ø–æ—Å—Ç–∞–≤–∏–ª –Ω–∞ –∫–æ—ç—Ñ: **{round(coef, 2)}**\n"
                                                       f"–¢–≤–æ—è —Å—Ç–∞–≤–∫–∞: **{bet}**"))

                        # –¢—É—Ç —É–∂–µ –≤—Ö–æ–¥–∏—Ç –≤ —Å–∏–ª—É –≤–∞—à–∞ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö.
                        # —Ç—É—Ç –≤—ã –¥–æ–ª–∂–Ω—ã —Å–Ω—è—Ç—å —Å –±–∞–ª–∞–Ω—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –µ–≥–æ —Å—Ç–∞–≤–∫—É


def setup(bot):
    bot.add_cog(Crash(bot))
